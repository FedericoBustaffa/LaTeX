
\subsection{Cambiamento di base negli endomorfismi lineari}
Sia $V$ uno spazio vettoriale di dimensione $n$ sul campo $\mathbb{K}$
e sia $L \in End(V)$. Supponiamo di avere due basi di $V$, una data dai vettori
$v_1, v_2, \dots, v_n$ e l'altra dai vettori $e_1, e_2, \dots, e_n$. Quello che
vedremo sar\`a la relazione che lega le matrici associate a $L$ rispetto a tali
basi,
\begin{equation*}
	[L]_{\substack{
			v_1, v_2, \dots, v_n \\
			v_1, v_2, \dots, v_n
		}}
\end{equation*}
e
\begin{equation*}
	[L]_{\substack{
			e_1, e_2, \dots, e_n \\
			e_1, e_2, \dots, e_n
		}}
\end{equation*}
Per prima cosa scriviamo ogni vettore $v_i$ come combinazione lineare dei vettori
della base $e_1, e_2, \dots, e_n$:
\begin{gather*}
	v_1 = a_{11}e_1 + a_{21}e_2 + \cdots + a_{n1}e_n \\
	v_2 = a_{12}e_1 + a_{22}e_2 + \cdots + a_{n2}e_n \\
	\cdots                                           \\
	v_n = a_{1n}e_1 + a_{2n}e_2 + \cdots + a_{nn}e_n \\
\end{gather*}
Se proviamo ora a scrivere la matrice associata all'endomorfismo identit\`a
$I \in End(V)$ prendendo come base in partenza $v_1, v_2, \dots, v_n$ e come base
in arrivo $e_1, e_2, \dots, e_n$ \`e la seguente:
\begin{equation*}
	[I]_{\substack{
			v_1, v_2, \dots, v_n \\
			e_1, e_2, \dots, e_n
		}} = \begin{pmatrix}
		a_{11} & a_{12} & \dots & a_{1n} \\
		a_{21} & a_{22} & \dots & \dots  \\
		\dots  & \dots  & \dots & \dots  \\
		a_{n1} & \dots  & \dots & a_{nn}
	\end{pmatrix}
\end{equation*}
Infatti nella prima colonna abbiamo scritto i coefficienti di $I(v_1)$ rispetto
alla base $e_1, e_2, \dots, e_n$, nella seconda colonna i coefficienti di
$I(v_2) = v_2$ e cos\`i via.

La matrice appena trovata \`e una matrice di
\textbf{cambiamento di base} e la chiameremo $M$. Osserviamo subito che $M$ \`e
invertibile. Infatti pensiamo alla composizione di endomorfismi $I \circ I$
ovvero $V \to^{I} V \to^{I} V$ e consideriamo il primo spazio $V$ e l'ultimo muniti
della base $v_1, v_2, \dots, v_n$, mentre lo spazio $V$ al centro lo consideriamo
con la base $e_1, e_2, \dots, e_n$. A questo punto otteniamo:
\begin{equation*}
	[I \circ I]_{\substack{
		v_1, v_2, \dots, v_n \\
		v_1, v_2, \dots, v_n
	}} =
		[I]_{\substack{
				e_1, e_2, \dots, e_n\\
				v_1, v_2, \dots, v_n
			}}
		[I]_{\substack{
				v_1, v_2, \dots, v_n\\
				e_1, e_2, \dots, e_n
			}}
\end{equation*}
Visto che $I \circ I = I$ possiamo riscrivere
\begin{equation*}
	[I]_{\substack{
		v_1, v_2, \dots, v_n \\
		v_1, v_2, \dots, v_n
	}} =
		[I]_{\substack{
				e_1, e_2, \dots, e_n\\
				v_1, v_2, \dots, v_n
			}}
		[I]_{\substack{
				v_1, v_2, \dots, v_n\\
				e_1, e_2, \dots, e_n
			}}
\end{equation*}
Ora la matrice al membro di sinistra \`e la matrice identit\`a $I$, mentre quella
pi\`u a destra \`e $M$, dunque:
\begin{equation*}
	I = [I]_{\substack{
		e_1, e_2, \dots, e_n\\
		v_1, v_2, \dots, v_n
	}} M
\end{equation*}
Questo ci permette di concludere che $M$ \`e invertibile e che
\[
	M^{-1} = [I]_{\substack{
				e_1, e_2, \dots, e_n\\
				v_1, v_2, \dots, v_n
			}}
\]
A questo punto possiamo enunciare il teorema che descrive la relazione fra matrici
assocaite a $L$ rispetto alle due diverse basi:
\begin{theorem}
	Con le notazioni introdotte sopra, vale:
	\begin{equation*}
		[L]_{\substack{
				v_1, v_2, \dots, v_n \\
				v_1, v_2, \dots, v_n
			}} =
		M^{-1}[L]_{\substack{
					e_1, e_2, \dots, e_n\\
					e_1, e_2, \dots, e_n
				}}M
	\end{equation*}
\end{theorem}

Ricordiamo che il problema di trovare la matrice associata a $L$ rispetto ad una
base se si conosce la matrice associata rispetto ad un'altra base pu\`o essere
affrontato anche senza scrivere le matrici $M$ e $M^{-1}$ ma il teorema precedente
ha una grande importanza dal punto di vista teorico.

Per esempio, se definiamo l'applicazione traccia
\begin{equation*}
	\tau : Mat_{n \times n}(\mathbb{K}) \to \mathbb{K}
\end{equation*}
nel seguente modo:
\begin{equation*}
	\tau((a_{ij})) = a_{11} + a_{22} + \dots + a_{nn}
\end{equation*}
\`e naturale chiedersi se, dato un endomorfismo $L \in End(V)$, la funzione traccia
dia lo stesso valore su tutte le matrici che si possono associare a $V$, in altre
parole se vale:
\begin{equation*}
	\tau \left(
	[L]_{\substack{
			v_1, v_2, \dots, v_n \\
			v_1, v_2, \dots, v_n
		}}
	\right) =
	\tau \left(
	[L]_{\substack{
			e_1, e_2, \dots, e_n \\
			e_1, e_2, \dots, e_n
		}}
	\right)
\end{equation*}
per ogni scelta delle basi $e_1, e_2, \dots, e_n$ e $v_1, v_2, \dots, v_n$.

La risposta \`e si: la traccia non dipende dalla base scelta e dunque possiamo
anche considerarla come applicazione lineare da $End(V)$ a $\mathbb{K}$.
Per mostrarlo scriviamo:
\begin{equation*}
	\tau \left(
	[L]_{\substack{
			v_1, v_2, \dots, v_n \\
			v_1, v_2, \dots, v_n
		}}
	\right) =
	\tau \left(
	M^{-1} [L]_{\substack{
			e_1, e_2, \dots, e_n \\
			e_1, e_2, \dots, e_n
		}} M
	\right)
\end{equation*}
A questo punto ricordiamo che per ogni $A, B \in Mat_{n \times n}(\mathbb{K})$
vale $\tau(AB) = \tau(BA)$, dunque:
\begin{gather*}
	\tau \left(
	\left(
		M^{-1}[L]_{\substack{
				e_1, e_2, \dots, e_n\\
				e_1, e_2, \dots, e_n
			}}
		\right) M
	\right) =\\
	\tau \left(
	M \left(
		M^{-1}[L]_{\substack{
				e_1, e_2, \dots, e_n\\
				e_1, e_2, \dots, e_n
			}}
		\right)
	\right) =\\
	\tau \left(
	M M^{-1} [L]_{\substack{
			e_1, e_2, \dots, e_n\\
			e_1, e_2, \dots, e_n
		}}
	\right) =\\
	\tau \left(
	[L]_{\substack{
			e_1, e_2, \dots, e_n \\
			e_1, e_2, \dots, e_n
		}}
	\right)
\end{gather*}
Questa catena di uguaglianza conduce, come annunciato, a:
\begin{equation*}
	\tau \left(
	[L]_{\substack{
			v_1, v_2, \dots, v_n \\
			v_1, v_2, \dots, v_n
		}}
	\right) =
	\tau \left(
	[L]_{\substack{
			e_1, e_2, \dots, e_n \\
			e_1, e_2, \dots, e_n
		}}
	\right)
\end{equation*}

\textbf{Ricapitolando:} Sia $V$ uno spazio vettoriale, sia $L \in End(V)$ e siano
$\mathcal{B}_1$ e $\mathcal{B}_2$ due basi di $V$. Se conosciamo la matrice
$[L]_{\substack{\mathcal{B}_1 \\ \mathcal{B}_1}}$ e vogliamo scrivere la matrice
$[L]_{\substack{\mathcal{B}_2 \\ \mathcal{B}_2}}$ passando per la matrice di
cambiamento di base dobbiamo:
\begin{enumerate}
	\item Trovare la matrice di cambiamento di base. Per farlo scriviamo la
	      matrice $[I]_{\substack{\mathcal{B}_1 \\ \mathcal{B}_2}}$ ovvero la
	      matrice associata all'indentit\`a con $\mathcal{B}_1$ in partenza e
	      $\mathcal{B}_2$ in arrivo. Questa sar\`a la nostra $M$.
	\item Troviamo l'inversa di $M$ tramite il metodo specificato al capitolo
	      precedente.
	\item A questo punto risolviamo
	      \[
		      [L]_{\substack{\mathcal{B}_2 \\ \mathcal{B}_2}} =
		      M^{-1} [L]_{\substack{\mathcal{B}_1 \\ \mathcal{B}_1}} M
	      \]
\end{enumerate}

\begin{example}
	Consideriamo $L : \mathbb{R}^2 \to \mathbb{R}^2$
	\[
		L \begin{pmatrix}
			x \\ y
		\end{pmatrix} =
		\begin{pmatrix}
			x + y \\ x
		\end{pmatrix}
	\]
	e la sua matrice associata rispetto alla base standard di $\mathbb{R}^2$ in
	partenza e in arrivo
	\[
		[L] = \begin{pmatrix}
			1 & 1 \\
			1 & 0
		\end{pmatrix}
	\]
	Vogliamo scrivere ora la matrice associata a $L$ rispetto alla base
	\[
		\mathcal{B} = \left\{
		\begin{pmatrix}
			1 \\ 1
		\end{pmatrix}, \quad
		\begin{pmatrix}
			0 \\ 1
		\end{pmatrix}
		\right\}
	\]
	di $\mathbb{R}^2$ in partenza e in arrivo. Per farlo seguiamo i punti elencati
	sopra.
	\begin{enumerate}
		\item Troviamo la matrice $M$ di cambiamento di base scrivendo la matrice
		      associata all'identit\`a con la base standard di $\mathbb{R}^2$ in partenza
		      e la base $\mathcal{B}$ in arrivo.
		      \[
			      M = \begin{pmatrix}
				      1 & 0 \\
				      1 & 1
			      \end{pmatrix}
		      \]
		\item Troviamo l'inversa di $M$.
		      \[
			      M^{-1} = \begin{pmatrix}
				      1  & 0 \\
				      -1 & 1
			      \end{pmatrix}
		      \]
		\item Scriviamo infine la matrice cercata risolvendo l'equazione
		      \[
			      [L]_{\substack{\mathcal{B} \\ \mathcal{B}}} =
			      M^{-1} [L] M
		      \]
		      Avremo dunque che
		      \begin{gather*}
			      [L]_{\substack{\mathcal{B} \\ \mathcal{B}}} =
			      \begin{pmatrix}
				      1  & 0 \\
				      -1 & 1
			      \end{pmatrix}
			      \begin{pmatrix}
				      1 & 1 \\
				      1 & 0
			      \end{pmatrix}
			      \begin{pmatrix}
				      1 & 0 \\
				      1 & 1
			      \end{pmatrix} \\
			      \Downarrow \\
			      [L]_{\substack{\mathcal{B} \\ \mathcal{B}}} =
			      \begin{pmatrix}
				      1 & 1  \\
				      0 & -1
			      \end{pmatrix}
			      \begin{pmatrix}
				      1 & 0 \\
				      1 & 1
			      \end{pmatrix} \\
			      \Downarrow \\
			      [L]_{\substack{\mathcal{B} \\ \mathcal{B}}} =
			      \begin{pmatrix}
				      2  & 1  \\
				      -1 & -1
			      \end{pmatrix}
		      \end{gather*}
	\end{enumerate}
	Lo stesso identico risultato si ottiene scrivendo esprimendo
	l'immagine di ogni elemento della base $\mathcal{B}$ come combinazione lineare
	della stessa base $\mathcal{B}$ e mettendo poi i vettori colonna ottenuti
	uno di fianco all'altro (come abbiamo visto nei primi capitoli).
\end{example}