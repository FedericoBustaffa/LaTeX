\section{Sistema dei tipi}
Uno dei principi fondamentali nella definizione di un linguaggio di programmazione è quello del \textbf{sistema di tipi}.
Questi non sono altro che un meccanismo in grado di rilevare errori di programmazione prima che il programma venga eseguito.

Il \textbf{tipo} è un attributo di un dato che descrive come il linguaggio di programmazione permette di usare quel
particolare dato.

Un tipo limita i valori che un'espressione, come una variabile o una funzione, può assumere. Inoltre, definisce le
operazioni che possono essere fatte sui dati e il modo in cui i valori di quel tipo possono essere memorizzati.

Un sistema di tipi è un metodo sintattico, effettivo per dimostrare l'assenza di comportamenti anomali del programma
strutturando le operazioni del programma in base ai tipi di valori che calcolano.
\begin{itemize}
	\item \textbf{Metodo sintattico}: la struttura sintattica guida il metodo di analisi del comportamento dei programmi.
	\item \textbf{Metodo effettivo}: si può definire un \textbf{algoritmo} che controlla i vincoli sui tipi e implementarlo
	      in un compilatore o in un interprete.
	\item \textbf{Metodo strutturale}: i tipi assegnati alle componenti di un programma sono calcolati in modo
	      \textbf{composizionale}. Il tipo di un espressione dipende quindi solo dai tipi delle sue sottoespressioni.
\end{itemize}
Un sistema di tipi associa quindi dei tipi ai valori calcolati ed esaminando il flusso dei valori calcolati, tenta di
dimostrare che non avvengano \textbf{errori di tipo}. Determina inoltre che cosa costituisce un errore di tipo, garantendo
che le operazioni che si aspettano un certo tipo di valore non siano utilizzate con valori per i quali quell'operazione non
ha senso.

\subsection{Controllo dei tipi}
La mancanza di \textbf{controlli sui tipi} permette di scrivere programmi pieni di bug, i quali possono essere sfruttati da
utenti malintenzionati per violare i sistemi informatici (\textbf{type safety}).

I controlli sul tipo possono essere \textbf{statici} o \textbf{dinamici}. Il primo viene fatto a tempo di compilazione e
segnala l'errore prima che il programma venga eseguito, il secondo viene fatto a tempo di esecuzione.

\subsubsection{Type Checker}
Il \textbf{type checker} è un meccanismo che permette di verificare che i vari dati siano usati correttamente all'interno di
espressioni e costrutti. In questo modo non si applica mai un'operazione ad un valore con il tipo non corretto per
quell'operazione, evitando così risultati sbagliati o indesiderati.

Si deve comunque tenere a mente che il controllo dei tipi è una forma di \textbf{correttezza parziale} del programma:
controlla solo gli \emph{errori di tipo} e non altri tipi di errore.

Per dimostrare la correttezza di un sistema di tipi è indispensabile comprendere nel dettaglio il \emph{significato} dei
programmi.

\subsection{Regole per i tipi}
Quando si definisce un linguaggio si definiscono delle regole per riuscire a definire sintassi e semantica di tale
linguaggio.

Nel caso in cui il linguaggio di riferimento comprenda anche dei tipi, stabilire delle regole per il controllo dei tipi
consiste nel definire una \textbf{relazione binaria} che associa una certa espressione ad un tipo.

Le regole di controllo di tipo, altro non sono che regole di inferenza che stabiliscono la correttezza delle operazioni
sulla base del loro tipo.

\subsubsection{Approssimazione}
I sistemi di tipo sono generalmente \textbf{imprecisi}: non definiscono esattamente quale sarà il tipo del valore restituito
dal programma. Definiscono invece un'\textbf{approssimazione conservativa}.

Il controllo potrebbe accettare più tipi diversi per lo stesso costrutto oppure assicurarsi che all'interno dello stesso
costrutto siano presenti due valori dello stesso tipo (generico).

\subsubsection{Composizionalità}
La regola di controllo di tipo condizionale
\[ \frac{E : Bool, \quad E_1 : T, \quad E_2 : T}{if \; E \; then \; E_1 \; else \; E_2 : T} \]
garantisce la \textbf{composizionalità} in quanto richiede che le espressioni del ramo \emph{then} e del ramo \emph{else}
abbiano lo stesso tipo e che quel tipo sia il tipo del condizionale.

Un'espressione, per essere usata in un certo contesto, deve avere un tipo ben preciso.

\subsubsection{Correttezza}
La \textbf{correttezza} del sistema di tipo è epressa formalmente da queste due proprietà:
\begin{itemize}
	\item \textbf{Progresso}: Se l'espressione $E$ ha tipo $T$ allora $E$ è un valore oppure $E \rightarrow E'$ per una
	      qualche espressione $E'$. Possiamo quindi affermare che un'espressione ben tipata non si blocca a tempo di
	      esecuzione.
	\item \textbf{Conservazione}: Se l'espressione $E$ ha tipo $T$ e $E \rightarrow E'$ allora l'espressione $E'$ ha
	      tipo $T$. In altre parole, i tipi sono preservati dalle regole di esecuzione.
\end{itemize}
Queste due proprietà, messe insieme, garantiscono che l'esecuzione dell'intera espressione non si blocchi.
