\section{Riduzione}
Il concetto di riduzione è fondamentale per riuscire a interagire
con classi di problemi differenti. Una \textbf{riduzione} è una
funzione che \emph{transforma} un problema $A$ (ovvero un insieme
o una classe) $A$ in un altro problema $B$, in modo da mantenerne
inalterata la caratteristica principale.

\begin{definition} \label{def: riduzione}
	Dati due problemi $A$ e $B$, diciamo che $A$ \textbf{si riduce}
	a $B$ secondo la \textbf{riduzione} $f$ e si indica con
	\[ A \leq_f B \]
	se e solo se
	\[ a \in A \iff f(a) \in B \]
	ovvero
	\[
		f(A) \subseteq B \quad \land
		\quad f(\overline{A}) \subseteq \overline{B}
	\]
\end{definition}

\begin{property}
	$A$ si riduce a $B$ secondo $f$ se e solo se
	$\overline{A} \leq_f \overline{B}$.
	\begin{proof}
		Si ha che
		\[
			x \in \overline{A} \iff x \notin A \iff
			f(x) \notin B \iff f(x) \in \overline{B}
		\]
	\end{proof}
\end{property}

Più in generale si definisce una \emph{relazione di riduzioni}
o \emph{famiglia} $\leq_F$ dove $F$ è una particolare classe di
funzioni. Allora scriveremo
\[ A \leq_F B \iff \exists f \in F \mid A \leq_f B \]
Noi siamo interessati a quelle riduzioni che $\leq_F$ che danno
origine a classi di problemi in qualche modo \emph{omogenei}.

\begin{lemma} \label{def: classificazione}
	Siano $\mathcal{D}$ e $\mathcal{E}$ due classi di problemi
	con $\mathcal{D} \subseteq \mathcal{E}$. Una relazione di
	riduzione $\leq_F$ \textbf{classifica} $\mathcal{D}$ e
	$\mathcal{E}$ se e solo se, per ogni problema $A$, $B$ e $C$
	\begin{itemize}
		\item $A \leq_F A$
		\item $A \leq_F B$ e $B \leq_F C$ implica $A \leq_F C$
		\item $A \leq_F B$ e $B \in \mathcal{D}$ implica
		      $A \in \mathcal{D}$
		\item $A \leq_F B$ e $B \in \mathcal{E}$ implica
		      $A \in \mathcal{E}$
	\end{itemize}
\end{lemma}

Di seguito vediamo una caratterizzazione differente ma del tutto
equivalente per le riduzioni che classificano coppie di classi,
l'una inclusa nell'altra.

\begin{lemma} \label{lemma: classificazione}
	Una relazione di riduzione $\leq_F$ classifica $\mathcal{D}$
	e $\mathcal{E}$, con $\mathcal{D} \subseteq \mathcal{E}$, se
	e solo se
	\begin{itemize}
		\item $id \in F$
		\item $f, g \in F \implies f \circ g \in F$
		\item $f \in F, \; B \in \mathcal{D} \implies
			      \{ x \mid f(x) \in B \} \in \mathcal{D}$
		\item $f \in F, \; B \in \mathcal{E} \implies
			      \{ x \mid f(x) \in B \} \in \mathcal{E}$
	\end{itemize}
\end{lemma}

Attraverso il concetto di relazione di riduzione che classifica
due classi di problemi si possono definire le seguenti nozioni
molto importanti.

\begin{definition}
	Se $\leq_F$ classifica $\mathcal{D}$ e $\mathcal{E}$, vale
	che per ogni problema $A, B, H$
	\begin{itemize}
		\item $A \equiv B$ se $A \leq_F B$ e $B \leq_F A$.
		\item $H$ è \textbf{$\leq_F$-arduo} per $\mathcal{E}$ se
		      $\forall A \in \mathcal{E}$ vale $A \leq_F H$.
		\item $H$ è \textbf{$\leq_F$-completo} per $\mathcal{E}$
		      se $H$ è $\leq_F$-arduo per $\mathcal{E}$ e
		      $H \in \mathcal{E}$.
	\end{itemize}
\end{definition}

Si dice anche che l'insieme
\[ \{ B \mid A \equiv_F B \} \]
è il \textbf{grado} di $A$ o anche che $A$ è equivalente a $B$
rispetto alla riduzione $\leq_F$. Quando la classe di riduzioni
$F$ è fissata, diremo semplicemente $\mathcal{E}$-arduo o
$\mathcal{E}$-completo

La relazione di riduzione $\leq_F$ è quello che viene chiamato
\textbf{pre-ordine parziale}, cioè un ordinamento parziale,
riflessivo e transitivo ma non anti-simmetrico. Nello specifico
\begin{itemize}
	\item Ogni elemento è in relazione con se stesso: $a \leq a$.
	\item Vale la transitività: $a \leq b$ e $b \leq c$ implicano
	      $a \leq c$.
	\item Non vale l'anti-simmetria: se $a \leq b$ e $b \leq a$
	      non possiamo dedurre che $a = b$.
\end{itemize}

\begin{property}
	Se $\leq_F$ \textbf{classifica} $\mathcal{D}$ ed $\mathcal{E}$
	con $\mathcal{D} \subseteq \mathcal{E}$ e $C$ è completo per
	$\mathcal{E}$, allora $C \in \mathcal{D}$ se e solo se
	\[ \mathcal{D} = \mathcal{E} \]
	\begin{proof}
		La parte \emph{"se"} della dimostrazione è ovvia. La
		parte \emph{"solo se"} si dimostra prendendo
		$C \in \mathcal{D}$ e $A \in \mathcal{E}$. Per
		la condizione di completezza di $\leq_F$, vale che
		$A \leq_F C$ e $A \in \mathcal{D}$ vista prima che
		classifica $\mathcal{D}$ ed $\mathcal{E}$. Quindi
		$\mathcal{E} \subseteq \mathcal{D}$ e la tesi.
	\end{proof}
\end{property}

Inoltre è facile capire quali siano gli elementi del grado di
$A$, problema $\leq_F$-completo per $\mathcal{E}$.

\begin{property}
	Se $A$ è completo per $\mathcal{E}$, $A \leq_F B$ e
	$B \in \mathcal{E}$, allora $B$ è completo per $\mathcal{E}$.
	\begin{proof}
		Per ogni $D \in \mathcal{E}$, $D \leq_F A$ per
		completezza, ma $\leq_F$ classifica $\mathcal{D}$ ed
		$\mathcal{E}$ e allora $D \leq_F A$ e $A \leq_F B$
		implicano $D \leq_F B$ e quindi $B$ è arduo e, poiché
		appartiene a $\mathcal{E}$, è completo.
	\end{proof}
\end{property}

Un problema completo per $\mathcal{E}$ rappresenta la difficoltà
massima dei problemi di $\mathcal{E}$. Infatti, è facile vedere
che il grado di un problema $A$ completo per $\mathcal{E}$ è il
grado massimo di $\mathcal{E}$ in  $\leq_F$. Valgono inoltre le
seguenti affermazioni (anche per problemi non completi):
\begin{itemize}
	\item Se $B \leq_F A$ allora $B$ al più ha il grado di $A$,
	      cioè è più facile o altrettanto difficile di $A$.
	\item Se $A \leq_F B$ allora $B$ ha almeno il grado di $A$,
	      cioè è di difficoltà maggiore o uguale a quella di $A$.
\end{itemize}

Passiamo ora riformulare le definizioni di \hyperref[def: riduzione]{riduzione}
e \hyperref[def: classificazione]{classificazione} per ottenere
il concetto di riducibilità che ci interessa. Per farlo diamo
un nome alla classe di funzioni calcolabili
\[ rec = \{ \varphi_x \mid \forall y \in \N . \varphi_x(y) \downarrow \} \]

\begin{definition}
	Il problema $A$ è \textbf{riducibile} a $B$ ($A \leq_{rec} B$)
	se e solamente se esiste una funzione calcolabile totale
	$f : \N \to \N$ tale che $x \in A$ se e solamente se
	$f(x) \in B$.
\end{definition}

Vogliamo vedere ora come le relazioni di riduzione conservano la
ricorsività e la ricorsiva enumerabilità. D'ora in poi ci
riferiremo agli insiemi $\mathcal{R}$ ed $\mathcal{RE}$, che
abbiamo definito in precedenza, come le classi di problemi
rispettivamente ricorsivi e ricorsivamente enumerabili.

\begin{theorem}
	La relazione di riduzione $\leq_{rec}$ classifica
	$\mathcal{R}$ ed $\mathcal{RE}$.
	\begin{proof}
		Sappiamo già che $\mathcal{R} \subseteq \mathcal{RE}$
		grazie alla proprietà \ref{prop: r_re}. Possiamo quindi
		usare il lemma \ref{lemma: classificazione} verificando
		che tutte le proprietà siano soddisfatte:
		\begin{itemize}
			\item L'identità appartiene a $rec$ poiché una
			      funzione calcolabile è $\mu$-ricorsiva.
			\item La composizione preserva la totalità.
			\item La funzione caratteristica di
			      $\{ x \mid f(x) \in B \}$ è $\chi_B \circ f$
			      che è calcolabile totale perché $f$ e $\chi_B$
			      lo sono.
			\item Analogo al punto precedente ma con la
			      semi-caratteristica di $B$.
		\end{itemize}
	\end{proof}
\end{theorem}

Nei teoremi e negli esericizi useremo principalmente funzioni
di riduzione iniettive di solito ricavate tramite il teorema
del parametro.

Il fatto che $\leq_{rec}$ classifichi $\mathcal{R}$ ed
$\mathcal{RE}$ può essere visto come la capacità che le
riduzioni con funzioni calcolabili totali hanno di
\textbf{separare} i problemi ricorsivi da quelli ricorsivamente
enumerabili.

Come abbiamo già visto, questo viene fatto giocando sul tempo
necessario a decidere un problema: \textbf{finito} nel caso
in cui sia ricorsivo, \textbf{infinito} in caso contrario.

Notiamo anche che ci basta trovare un problema che sia
$\leq_{rec}$-completo per $\mathcal{R}$ per poter vedere quali
problemi sono decidibili e quali no.

Ancora più interessante è trovare un problema
$\leq_{rec}$-completo per $\mathcal{RE}$, così da capire quali
problemi sono al più semi-decidibili e quali nemmeno
semi-decidibili. Basta infatti ridurre il problema da studiare a
quello completo sapere che è ricorsivamente enumerabile oppure
ridurre il problema completo a quello da studiare e sapremo che
quest'ultimo, ben che vada, è ricorsivamente enumerabile.

% Impossibile ridurre K a K^- o viceversa


\begin{theorem}
	L'insieme $K$ è $\mathcal{RE}$-completo, ovvero
	$\leq_{rec}$-completo per $\mathcal{RE}$.
	\begin{proof}
		Dobbiamo dimostrare che se $A \in \mathcal{RE}$ allora
		$A \leq_{rec} K$. Per definizione $A$ è il dominio di
		una funzione calcolabile $\psi$, ovvero
		\[ A = \{ x \mid \psi (x) \downarrow \} \]
		A partire da $\psi$ definiamo la funzione $\psi'$ a due
		variabili di cui ignoriamo la seconda
		\[ \psi' (x, y) = \psi(x) \]
		che è calcolabile, dunque ha un indice $i$ tale che
		$\psi' = \varphi_i$, allora per il teorema del parametro
		\[ \psi' (x, y) = \varphi_i(x, y) = \varphi_{s(i, x)} (y) \]
		con $s$ calcolabile, iniettiva e totale. Possiamo quindi
		scrivere la definizione di $A$ come segue
		\begin{align*}
			A & = \{ x \mid \psi(x) \downarrow \}                    \\
			  & = \{ x \mid \psi'(x, y) \downarrow \}                \\
			  & = \{ x \mid \varphi_i(x, y) \downarrow \}            \\
			  & = \{ x \mid \varphi_{s(i, x)}(y) \downarrow \}       \\
			  & = \{ x \mid \varphi_{s(i, x)}(s(i, x)) \downarrow \} \\
			  & = \{ x \mid s(i, x) \in K \}
		\end{align*}
		quindi $x \in A$ se e solo se $f(x) \in K$ con
		$f(x) = \lambda x . s(i, x)$ che è calcolabile, totale
		e iniettiva perché $s(i, x)$ lo è.
	\end{proof}
\end{theorem}

Questo teorema ci dice che tutti gli insiemi ricorsivamente
enumerabili si riducono, per mezzo di una funzione calcolabile,
totale a $K$.
