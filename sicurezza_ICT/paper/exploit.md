# Exploit Kit

Gli exploit fanno uso di un numero molto limitato di 
vulnerabilità. Il loro punto di forza è il _supporto_
che forniscono a chi ne fa uso nell'evitare il rilevamento,
monitorare il traffico e nella gestione dell'exploit.

## Introduzione

Negli ultimi anni c'è stata una grande crescita nell'utilizzo 
di malware che, tramite URL maliziosi, vengono scaricati 
e installati sulla macchina della vittima.

Questo tipo di attacco è chiamato **drive-by-download**.

Nel migliore dei casi, compromettere dei client dietro un 
firewall, potrebbe causare problemi di grande entità su sistemi 
critici.

Nel migliore dei casi potrebbero essere invece usati per la 
creazione di infrastrutture di controllo da cui iniziare altri
attacchi.

Gli attacchi drive-by-download sono gestiti dai cosiddetti 
**exploit kit**, ovvero dei server che distribuiscono malware 
invece che contenuti.

Il loro punto di forza è quello di fornire dei _prodotti_ 
utilizzabili anche da qualcuno che non possiede particolari 
competenze.

### Meccanismo di distribuzione

Al contrario di quanto ci si potrebbe aspettare, il 
**meccanismo di distribuzione** degli exploit non attua 
un'analisi mirata per decidere quale sia la vittima.

Al contrario fa uso di un sistema che mira alla distribuzione
su larga scala dei malware, al fine di rendere l'esperienza 
dell'_utente_ migliore.

In pratica ci si aspetta che un ampio numero di infezioni
corrisponda ad un'ampia distribuzione di malware piuttosto
che a pochi attacchi ma ben mirati.

## Analisi degli exploit kit

Lo studio di questi software di distribuzione degli exploit non
è un argomento preso molto molto in considerazione. In genere 
ci si concentra più su altre cose come l'analisi degli exploit
distribuiti.

## Panoramica

Un exploit kit è uno strumento software distribuito per attuare
attacchi di tipo drive-by-download.

L'implementazione principale consiste in un'applicazione 
server in grado di reindirizzare il traffico verso una pagina 
contenente un insieme di exploit. Il kit ha come obbiettivo 
quello di scaricare ed eseguire gli exploit sulla macchina 
client che si connette alla pagina in modo che la vittima 
non si accorga di nulla.

Più nello specifico, viene scaricato un exploit in grado di
iniettare istruzioni (**shellcode**) nella macchina della 
vittima in grado di scaricare, installare ed eseguire exploit 
più complessi e scelti dall'attaccante.

Il protocollo più comune si compone dei seguenti passi:

1. Un utente della rete visita un sito compromesso e viene
reindirizzato alla pagina dell'exploit kit.
2. La pagina a questo punto invia un documento HTML contenente
il codice degli exploit offuscato (in genere codice JavaScript).
3. Se almeno uno degli exploit viene eseguito con successo, la
macchina della vittima viene infettata.

Un'intrusione ha successo nel momento in cui lo shellcode 
termina la sua esecuzione senza problemi.

I parametri per il successo dell'attacco sono molteplici come 
il sistema operativo della vittima e relativa versione, il 
browser ecc.